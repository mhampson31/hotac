{% extends 'base.html' %}

{% load crispy_forms_tags %}
{% load xwf_extras %}

{% block content %}

<div class="row">
    <div class="col">
        <p>Player: {{pilot.user}}</p>
        <p>Callsign: {{pilot.callsign}}</p>
        <p>Game: <a href="{% url 'game' pilot.game.id %}">{{pilot.game}}</a></p>
        <p>Missions Flown: {{missions}}</p>
        <p>Initiative {{pilot.initiative}}</p>
    </div>
    <div class="col">
        <div class="col">XP Earned: <i class="xwf xwf-squad-point-cost"></i>{{pilot.total_xp}}</div>
        <div class="col">XP Available: <i class="xwf xwf-squad-point-cost"></i>{{remaining}}</div>
    </div>

    <form method='post' class='col'>
        {{update|crispy }}
    </form>
</div>


<div class="row mb-1">
    <h6 class='col'><a href="{% url 'chassis' chassis_slug=pilot.active_ship.slug %}">{{pilot.active_ship.name}} <i class="xw-ship xw-ship-{{pilot.active_ship.css_name}}"></i></a></h6>
</div>

<div class="row mb-1">
    <ul class="col list-group list-group-horizontal">
    {% for slot in pilot.slots %}
      <li class="list-group-item">{{slot|get_icon}}<li>
    {% endfor %}
    </ul>
</div>

<div class="row mb-3">
    <div class="col">
        <h4>Upgrades</h4>
            {% regroup pilot.upgrades.all by get_type_display as upgrade_list %}
            {% for upgrade_type, upgrades in upgrade_list %}
        <div class="row">
            <ul class="list-inline col mb-1">
            {% for upgrade in upgrades %}
                <li class="list-inline-item">
                    {{upgrade.get_type_display|get_icon}}
                    {% if upgrade.type2 %}
                    {{upgrade.get_type2_display|get_icon}}
                    {% endif %}
                    {{upgrade}}
                </li>
            {% endfor %}
            </ul>
        </div>
        {% endfor %}
    </div>
</div>



<div class="row">
    <div class="col">
        <h5>Achievements</h5>
        <ul class="list-group col">
        {% for ach in achievements %}
            <li class="list-group-item">{{ach.event__long_desc}}
                                        {% if ach.target__enemy__chassis__name %}
                                        {{ach.target__enemy__chassis__name}}
                                        {% endif %} <span class="badge badge-primary badge-pill">x{{ach.count}}</span></li>
        {% endfor %}
        </ul>

    </div>

</div>

{% endblock %}
